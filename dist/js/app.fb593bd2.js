(function(){"use strict";var e={433:function(e,t,s){var r=s(144),n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[s("AppContent"),s("AppModal")],1)},a=[],o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"content"},[e._m(0),s("div",{staticClass:"content__row --suppressed"},[s("UsersTable")],1),s("div",{staticClass:"content__row"},[s("button",{staticClass:"content__button button --blue",on:{click:e.openModal}},[e._v(" Добавить ")])])])},i=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"content__row"},[s("h1",{staticClass:"content__title"},[e._v(" Список пользователей ")])])}],l=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("table",{staticClass:"content__table table"},[s("thead",[s("tr",{staticClass:"table__row --head"},[s("th",{attrs:{colspan:"1"}},[s("div",{staticClass:"table__cell",on:{click:function(t){return e.changeSort("name")}}},[s("span",{staticClass:"table__span"},[e._v("Имя")])])]),s("th",{attrs:{colspan:"1"}},[s("div",{staticClass:"table__cell",on:{click:function(t){return e.changeSort("phone")}}},[s("span",{staticClass:"table__span"},[e._v("Телефон")])])])])]),e.usersList.length>0?s("tbody",e._l(e.usersList,(function(t){return s("tr",{key:t.id,staticClass:"table__row"},[s("td",[s("div",{staticClass:"table__cell",style:e.getUserMargin(t)},[e._v(" "+e._s(t.name)+" ")])]),s("td",[s("div",{staticClass:"table__cell"},[e._v(e._s(t.phone))])])])})),0):s("tbody",[e._m(0)])])},u=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("tr",{staticClass:"table__row"},[s("td",{attrs:{colspan:"2"}},[s("div",{staticClass:"table__cell"},[e._v(" Нет пользователей ")])])])}],c=s(629);class d{constructor(e="id"){this.parameter=e,this.isReversed=!1}setValues(e){e!==this.parameter?this.constructor(e):this.isReversed?this.constructor():this.isReversed=!0}getValues(){return{parameter:this.parameter,isReversed:this.isReversed}}}var p={name:"UsersTable",data(){return{sort:new d}},created(){localStorage.roistatStorage&&this.initUsers()},methods:{...(0,c.OI)(["initUsers","sortUsers"]),getUserMargin(e){return 0===e.subordinationLevel?{}:{marginLeft:15*e.subordinationLevel+"px"}},changeSort(e){0!==this.usersList.length&&(this.sort.setValues(e),this.sortUsers(this.sort.getValues()))}},computed:{...(0,c.Se)(["usersList"])}},h=p,m=s(1),v=(0,m.Z)(h,l,u,!1,null,null,null),_=v.exports,f={name:"AppContent",components:{UsersTable:_},methods:{openModal(){this.$modal.showModal()}}},b=f,g=(0,m.Z)(b,o,i,!1,null,null,null),C=g.exports,w=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.modalIsOpened?s("div",{staticClass:"app__modal-container",on:{click:function(t){return t.target!==t.currentTarget?null:e.closeModal.apply(null,arguments)}}},[s("div",{staticClass:"app__modal modal"},[s("div",{staticClass:"modal__icon",on:{click:e.closeModal}},[s("span"),s("span")]),e._m(0),s("div",{staticClass:"modal__content"},[s("form",{staticClass:"form"},[s("div",{staticClass:"form__row"},[s("label",{staticClass:"form__label",attrs:{for:"name"}},[e._v("Имя")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.user.name,expression:"user.name"}],staticClass:"input",attrs:{type:"text",name:"name",placeholder:"Имя"},domProps:{value:e.user.name},on:{input:function(t){t.target.composing||e.$set(e.user,"name",t.target.value)}}})]),s("div",{staticClass:"form__row"},[s("label",{staticClass:"form__label",attrs:{for:"phone"}},[e._v("Телефон")]),s("input",{directives:[{name:"maska",rawName:"v-maska",value:"+7 (###) ### ## ##",expression:"'+7 (###) ### ## ##'"},{name:"model",rawName:"v-model",value:e.user.phone,expression:"user.phone"}],staticClass:"input",attrs:{type:"text",name:"phone",placeholder:"+7 (900) 000 00 00"},domProps:{value:e.user.phone},on:{input:function(t){t.target.composing||e.$set(e.user,"phone",t.target.value)}}})]),s("div",{staticClass:"form__row"},[s("label",{staticClass:"form__label",attrs:{for:"superior"}},[e._v("Начальник")]),s("select",{directives:[{name:"model",rawName:"v-model",value:e.user.superior,expression:"user.superior"}],staticClass:"select",attrs:{name:"superior",disabled:0===e.usersList.length},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.user,"superior",t.target.multiple?s:s[0])}}},e._l(e.usersList,(function(t){return s("option",{key:t.id,domProps:{value:t}},[e._v(" "+e._s(t.name)+" ")])})),0)]),s("div",{staticClass:"form__row"},[s("button",{staticClass:"form__button button --blue",attrs:{disabled:!e.formIsFilled},on:{click:e.updateUsers}},[e._v(" Сохранить ")])])])])])]):e._e()},y=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"modal__header"},[s("h3",{staticClass:"modal__title"},[e._v("Добавление пользователя")])])}],U=s(424);const T={install(e){this.eventBus=new e,e.component("modal",$),e.prototype.$modal={showModal(){T.eventBus.$emit("showModal")}}}};var L=T;const M=()=>({name:void 0,phone:void 0,superior:void 0});var O={name:"AppModal",directives:{maska:U.RY},data(){return{modalIsOpened:!1,user:M()}},beforeMount(){L.eventBus.$on("showModal",(()=>{this.showModal()}))},methods:{...(0,c.OI)(["addUser"]),showModal(){document.body.style="overflow: hidden;",this.modalIsOpened=!0},closeModal(){document.body.style="",this.user=M(),this.modalIsOpened=!1},updateUsers(){const e={name:this.user.name,phone:this.user.phone,superiorId:this.user.superior?this.user.superior.id:null,subordinationLevel:this.user.superior?this.user.superior.subordinationLevel+1:0,subordinates:[]};this.addUser(e),localStorage.roistatStorage=JSON.stringify(this.usersTree),this.closeModal()}},computed:{...(0,c.Se)(["usersList"]),...(0,c.rn)(["usersTree"]),phoneIsValid(){const e=/^\+7 \(\d{3}\) \d{3} \d{2} \d{2}$/;return e.test(this.user.phone)},formIsFilled(){return this.user.name&&this.phoneIsValid}}},k=O,x=(0,m.Z)(k,w,y,!1,null,null,null),$=x.exports,S={name:"App",components:{AppContent:C,AppModal:$}},I=S,Z=(0,m.Z)(I,n,a,!1,null,null,null),A=Z.exports;class E{constructor(e=[]){this.usersTree=e}addUser(e,t=this.usersTree,s=null){if(e.superiorId!==s){if(0!==t.length)for(let r=0;r<t.length;r++)this.addUser(e,t[r].subordinates,t[r].id)}else t.push({...e,subordinates:[]})}getUsersList(e=[],t=this.usersTree){if(0===t.length)return[];for(let s=0;s<t.length;s++)e.push({name:t[s].name,phone:t[s].phone,id:t[s].id,subordinationLevel:t[s].subordinationLevel}),t[s].subordinates.length&&this.getUsersList(e,t[s].subordinates);return e}sort(e,t,s=this.usersTree){if(0!==s.length){s.sort(((t,s)=>t[e]<s[e]?-1:t[e]>s[e]?1:0)),t&&s.reverse();for(let r=0;r<s.length;r++)s[r].subordinates.length&&this.sort(e,t,s[r].subordinates)}}}r.Z.use(c.ZP);var j=new c.ZP.Store({state:{usersTree:new E},getters:{usersList(e){return e.usersTree.getUsersList()}},mutations:{initUsers(e){e.usersTree=new E(JSON.parse(localStorage.roistatStorage).usersTree)},sortUsers(e,t){e.usersTree.sort(t.parameter,t.isReversed)},addUser(e,t){let s=0;e.usersTree.getUsersList().length>0&&(s=Math.max(...e.usersTree.getUsersList().map((e=>e.id)))+1),e.usersTree.addUser({...t,id:s})}}}),N=s(947),P=s(436),R=s(810);r.Z.config.productionTip=!1,r.Z.use(L),N.vI.add(P.G_j),r.Z.component("font-awesome-icon",R.GN),new r.Z({store:j,render:e=>e(A)}).$mount("#app")}},t={};function s(r){var n=t[r];if(void 0!==n)return n.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,s),a.exports}s.m=e,function(){var e=[];s.O=function(t,r,n,a){if(!r){var o=1/0;for(c=0;c<e.length;c++){r=e[c][0],n=e[c][1],a=e[c][2];for(var i=!0,l=0;l<r.length;l++)(!1&a||o>=a)&&Object.keys(s.O).every((function(e){return s.O[e](r[l])}))?r.splice(l--,1):(i=!1,a<o&&(o=a));if(i){e.splice(c--,1);var u=n();void 0!==u&&(t=u)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[r,n,a]}}(),function(){s.d=function(e,t){for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};s.O.j=function(t){return 0===e[t]};var t=function(t,r){var n,a,o=r[0],i=r[1],l=r[2],u=0;if(o.some((function(t){return 0!==e[t]}))){for(n in i)s.o(i,n)&&(s.m[n]=i[n]);if(l)var c=l(s)}for(t&&t(r);u<o.length;u++)a=o[u],s.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return s.O(c)},r=self["webpackChunkroistat_test"]=self["webpackChunkroistat_test"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=s.O(void 0,[998],(function(){return s(433)}));r=s.O(r)})();
//# sourceMappingURL=app.fb593bd2.js.map