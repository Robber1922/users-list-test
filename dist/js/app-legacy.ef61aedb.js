(function(){"use strict";var e={8433:function(e,t,s){s(6992),s(8674),s(9601),s(7727);var n=s(144),r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[s("AppContent"),s("AppModal")],1)},o=[],a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"content"},[e._m(0),s("div",{staticClass:"content__row --suppressed"},[s("UsersTable")],1),s("div",{staticClass:"content__row"},[s("button",{staticClass:"content__button button --blue",on:{click:e.openModal}},[e._v(" Добавить ")])])])},i=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"content__row"},[s("h1",{staticClass:"content__title"},[e._v(" Список пользователей ")])])}],l=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("table",{staticClass:"content__table table"},[s("thead",[s("tr",{staticClass:"table__row --head"},[s("th",{attrs:{colspan:"1"}},[s("div",{staticClass:"table__cell",on:{click:function(t){return e.changeSort("name")}}},[s("span",{staticClass:"table__span"},[e._v("Имя")])])]),s("th",{attrs:{colspan:"1"}},[s("div",{staticClass:"table__cell",on:{click:function(t){return e.changeSort("phone")}}},[s("span",{staticClass:"table__span"},[e._v("Телефон")])])])])]),e.usersList.length>0?s("tbody",e._l(e.usersList,(function(t){return s("tr",{key:t.id,staticClass:"table__row"},[s("td",[s("div",{staticClass:"table__cell",style:e.getUserMargin(t)},[e._v(" "+e._s(t.name)+" ")])]),s("td",[s("div",{staticClass:"table__cell"},[e._v(e._s(t.phone))])])])})),0):s("tbody",[e._m(0)])])},u=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("tr",{staticClass:"table__row"},[s("td",{attrs:{colspan:"2"}},[s("div",{staticClass:"table__cell"},[e._v(" Нет пользователей ")])])])}],c=s(3019),d=(s(2707),s(629)),p=s(6133),v=s(2751),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id";(0,p.Z)(this,e),this.parameter=t,this.isReversed=!1}return(0,v.Z)(e,[{key:"setValues",value:function(e){e!==this.parameter?this.constructor(e):this.isReversed?this.constructor():this.isReversed=!0}},{key:"getValues",value:function(){return{parameter:this.parameter,isReversed:this.isReversed}}}]),e}(),f={name:"UsersTable",data:function(){return{sort:new h}},created:function(){localStorage.roistatStorage&&this.initUsers()},methods:(0,c.Z)((0,c.Z)({},(0,d.OI)(["initUsers","sortUsers"])),{},{getUserMargin:function(e){return 0===e.subordinationLevel?{}:{marginLeft:15*e.subordinationLevel+"px"}},changeSort:function(e){0!==this.usersList.length&&(this.sort.setValues(e),this.sortUsers(this.sort.getValues()))}}),computed:(0,c.Z)({},(0,d.Se)(["usersList"]))},m=f,_=s(1001),b=(0,_.Z)(m,l,u,!1,null,null,null),g=b.exports,C={name:"AppContent",components:{UsersTable:g},methods:{openModal:function(){this.$modal.showModal()}}},w=C,y=(0,_.Z)(w,a,i,!1,null,null,null),Z=y.exports,U=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.modalIsOpened?s("div",{staticClass:"app__modal-container",on:{click:function(t){return t.target!==t.currentTarget?null:e.closeModal.apply(null,arguments)}}},[s("div",{staticClass:"app__modal modal"},[s("div",{staticClass:"modal__icon",on:{click:e.closeModal}},[s("span"),s("span")]),e._m(0),s("div",{staticClass:"modal__content"},[s("form",{staticClass:"form"},[s("div",{staticClass:"form__row"},[s("label",{staticClass:"form__label",attrs:{for:"name"}},[e._v("Имя")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.user.name,expression:"user.name"}],staticClass:"input",attrs:{type:"text",name:"name",placeholder:"Имя"},domProps:{value:e.user.name},on:{input:function(t){t.target.composing||e.$set(e.user,"name",t.target.value)}}})]),s("div",{staticClass:"form__row"},[s("label",{staticClass:"form__label",attrs:{for:"phone"}},[e._v("Телефон")]),s("input",{directives:[{name:"maska",rawName:"v-maska",value:"+7 (###) ### ## ##",expression:"'+7 (###) ### ## ##'"},{name:"model",rawName:"v-model",value:e.user.phone,expression:"user.phone"}],staticClass:"input",attrs:{type:"text",name:"phone",placeholder:"+7 (900) 000 00 00"},domProps:{value:e.user.phone},on:{input:function(t){t.target.composing||e.$set(e.user,"phone",t.target.value)}}})]),s("div",{staticClass:"form__row"},[s("label",{staticClass:"form__label",attrs:{for:"superior"}},[e._v("Начальник")]),s("select",{directives:[{name:"model",rawName:"v-model",value:e.user.superior,expression:"user.superior"}],staticClass:"select",attrs:{name:"superior",disabled:0===e.usersList.length},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.user,"superior",t.target.multiple?s:s[0])}}},e._l(e.usersList,(function(t){return s("option",{key:t.id,domProps:{value:t}},[e._v(" "+e._s(t.name)+" ")])})),0)]),s("div",{staticClass:"form__row"},[s("button",{staticClass:"form__button button --blue",attrs:{disabled:!e.formIsFilled},on:{click:e.updateUsers}},[e._v(" Сохранить ")])])])])])]):e._e()},k=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"modal__header"},[s("h3",{staticClass:"modal__title"},[e._v("Добавление пользователя")])])}],T=(s(8309),s(8862),s(4916),s(7601),s(9424)),L={install:function(e){this.eventBus=new e,e.component("modal",I),e.prototype.$modal={showModal:function(){L.eventBus.$emit("showModal")}}}},M=L,O=function(){return{name:void 0,phone:void 0,superior:void 0}},x={name:"AppModal",directives:{maska:T.RY},data:function(){return{modalIsOpened:!1,user:O()}},beforeMount:function(){var e=this;M.eventBus.$on("showModal",(function(){e.showModal()}))},methods:(0,c.Z)((0,c.Z)({},(0,d.OI)(["addUser"])),{},{showModal:function(){document.body.style="overflow: hidden;",this.modalIsOpened=!0},closeModal:function(){document.body.style="",this.user=O(),this.modalIsOpened=!1},updateUsers:function(){var e={name:this.user.name,phone:this.user.phone,superiorId:this.user.superior?this.user.superior.id:null,subordinationLevel:this.user.superior?this.user.superior.subordinationLevel+1:0,subordinates:[]};this.addUser(e),localStorage.roistatStorage=JSON.stringify(this.usersTree),this.closeModal()}}),computed:(0,c.Z)((0,c.Z)((0,c.Z)({},(0,d.Se)(["usersList"])),(0,d.rn)(["usersTree"])),{},{phoneIsValid:function(){var e=/^\+7 \(\d{3}\) \d{3} \d{2} \d{2}$/;return e.test(this.user.phone)},formIsFilled:function(){return this.user.name&&this.phoneIsValid}})},$=x,S=(0,_.Z)($,U,k,!1,null,null,null),I=S.exports,A={name:"App",components:{AppContent:Z,AppModal:I}},E=A,j=(0,_.Z)(E,r,o,!1,null,null,null),N=j.exports,P=s(4479),R=(s(1249),function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];(0,p.Z)(this,e),this.usersTree=t}return(0,v.Z)(e,[{key:"addUser",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.usersTree,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(e.superiorId!==s){if(0!==t.length)for(var n=0;n<t.length;n++)this.addUser(e,t[n].subordinates,t[n].id)}else t.push((0,c.Z)((0,c.Z)({},e),{},{subordinates:[]}))}},{key:"getUsersList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.usersTree;if(0===t.length)return[];for(var s=0;s<t.length;s++)e.push({name:t[s].name,phone:t[s].phone,id:t[s].id,subordinationLevel:t[s].subordinationLevel}),t[s].subordinates.length&&this.getUsersList(e,t[s].subordinates);return e}},{key:"sort",value:function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.usersTree;if(0!==s.length){s.sort((function(t,s){return t[e]<s[e]?-1:t[e]>s[e]?1:0})),t&&s.reverse();for(var n=0;n<s.length;n++)s[n].subordinates.length&&this.sort(e,t,s[n].subordinates)}}}]),e}());n.Z.use(d.ZP);var V=new d.ZP.Store({state:{usersTree:new R},getters:{usersList:function(e){return e.usersTree.getUsersList()}},mutations:{initUsers:function(e){e.usersTree=new R(JSON.parse(localStorage.roistatStorage).usersTree)},sortUsers:function(e,t){e.usersTree.sort(t.parameter,t.isReversed)},addUser:function(e,t){var s=0;e.usersTree.getUsersList().length>0&&(s=Math.max.apply(Math,(0,P.Z)(e.usersTree.getUsersList().map((function(e){return e.id}))))+1),e.usersTree.addUser((0,c.Z)((0,c.Z)({},t),{},{id:s}))}}}),B=s(8947),F=s(1436),G=s(7810);n.Z.config.productionTip=!1,n.Z.use(M),B.vI.add(F.G_j),n.Z.component("font-awesome-icon",G.GN),new n.Z({store:V,render:function(e){return e(N)}}).$mount("#app")}},t={};function s(n){var r=t[n];if(void 0!==r)return r.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,s),o.exports}s.m=e,function(){var e=[];s.O=function(t,n,r,o){if(!n){var a=1/0;for(c=0;c<e.length;c++){n=e[c][0],r=e[c][1],o=e[c][2];for(var i=!0,l=0;l<n.length;l++)(!1&o||a>=o)&&Object.keys(s.O).every((function(e){return s.O[e](n[l])}))?n.splice(l--,1):(i=!1,o<a&&(a=o));if(i){e.splice(c--,1);var u=r();void 0!==u&&(t=u)}}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[n,r,o]}}(),function(){s.d=function(e,t){for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};s.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,o,a=n[0],i=n[1],l=n[2],u=0;if(a.some((function(t){return 0!==e[t]}))){for(r in i)s.o(i,r)&&(s.m[r]=i[r]);if(l)var c=l(s)}for(t&&t(n);u<a.length;u++)o=a[u],s.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return s.O(c)},n=self["webpackChunkroistat_test"]=self["webpackChunkroistat_test"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=s.O(void 0,[998],(function(){return s(8433)}));n=s.O(n)})();
//# sourceMappingURL=app-legacy.ef61aedb.js.map